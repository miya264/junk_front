"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/messages/page",{

/***/ "(app-pages-browser)/./src/hooks/useChat.ts":
/*!******************************!*\
  !*** ./src/hooks/useChat.ts ***!
  \******************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useChat: function() { return /* binding */ useChat; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _utils_api__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/api */ \"(app-pages-browser)/./src/utils/api.ts\");\n\n\nconst API_BASE_URL = \"http://127.0.0.1:8000\" || 0;\n// セッション管理をローカルストレージに永続化\nconst STORAGE_KEY = \"chat_sessions\";\nconst useChat = (onStepChange)=>{\n    const [sessions, setSessions] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [currentSessionId, setCurrentSessionId] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [error, setError] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [sessionState, setSessionState] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const currentSession = sessions.find((s)=>s.id === currentSessionId);\n    const messages = (currentSession === null || currentSession === void 0 ? void 0 : currentSession.messages) || [];\n    // ローカルストレージからセッションを読み込み\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        try {\n            const savedSessions = localStorage.getItem(STORAGE_KEY);\n            if (savedSessions) {\n                const parsed = JSON.parse(savedSessions);\n                // Date オブジェクトを復元\n                const sessionsWithDates = parsed.map((session)=>({\n                        ...session,\n                        createdAt: new Date(session.createdAt),\n                        updatedAt: new Date(session.updatedAt),\n                        messages: session.messages.map((msg)=>({\n                                ...msg,\n                                timestamp: new Date(msg.timestamp)\n                            }))\n                    }));\n                setSessions(sessionsWithDates);\n            }\n        } catch (error) {\n            console.error(\"Failed to load sessions from localStorage:\", error);\n        }\n    }, []);\n    // セッションをローカルストレージに保存\n    const saveSessions = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((newSessions)=>{\n        try {\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(newSessions));\n        } catch (error) {\n            console.error(\"Failed to save sessions to localStorage:\", error);\n        }\n    }, []);\n    const createNewSession = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((firstMessage)=>{\n        const sessionId = Date.now().toString();\n        const title = firstMessage.length > 30 ? firstMessage.substring(0, 30) + \"...\" : firstMessage;\n        const newSession = {\n            id: sessionId,\n            title,\n            messages: [],\n            createdAt: new Date(),\n            updatedAt: new Date()\n        };\n        setSessions((prevSessions)=>{\n            const newSessions = [\n                newSession,\n                ...prevSessions\n            ];\n            saveSessions(newSessions);\n            return newSessions;\n        });\n        setCurrentSessionId(sessionId);\n        return sessionId;\n    }, [\n        saveSessions\n    ]);\n    const selectSession = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((sessionId)=>{\n        setCurrentSessionId(sessionId);\n        setError(null);\n    }, []);\n    const startNewChat = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(()=>{\n        setCurrentSessionId(null);\n        setError(null);\n    }, []);\n    const convertApiMessageToMessage = (apiMsg)=>({\n            id: apiMsg.id,\n            content: apiMsg.content,\n            role: apiMsg.type === \"ai\" ? \"assistant\" : \"user\",\n            timestamp: new Date(apiMsg.timestamp),\n            searchType: apiMsg.search_type === \"fact\" || apiMsg.search_type === \"network\" ? apiMsg.search_type : undefined\n        });\n    const sendMessage = (0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)(async (content, searchType, flowStep, projectId)=>{\n        let sessionId = currentSessionId;\n        // 新しいセッションを作成（初回メッセージの場合）\n        if (!sessionId) {\n            sessionId = createNewSession(content);\n        }\n        const userMessage = {\n            id: Date.now().toString(),\n            content,\n            role: \"user\",\n            timestamp: new Date(),\n            searchType: searchType === \"fact\" || searchType === \"network\" ? searchType : undefined\n        };\n        // ユーザーメッセージを追加（関数型更新を使用）\n        setSessions((prevSessions)=>{\n            const updatedSessions = prevSessions.map((session)=>session.id === sessionId ? {\n                    ...session,\n                    messages: [\n                        ...session.messages,\n                        userMessage\n                    ],\n                    updatedAt: new Date()\n                } : session);\n            saveSessions(updatedSessions);\n            return updatedSessions;\n        });\n        setIsLoading(true);\n        setError(null);\n        try {\n            // バックエンドにメッセージを送信\n            const requestData = {\n                content,\n                search_type: searchType,\n                flow_step: flowStep,\n                session_id: sessionId,\n                project_id: projectId\n            };\n            let response;\n            let assistantMessage;\n            // 検索タイプが指定されている場合はRAG/通常チャットAPIを優先\n            // （バックエンド側は search_type 優先で処理されるため flow_step 同送でも問題なし）\n            if (searchType === \"fact\" || searchType === \"network\") {\n                response = await _utils_api__WEBPACK_IMPORTED_MODULE_1__.api.sendMessage(requestData);\n                assistantMessage = convertApiMessageToMessage(response);\n            } else if (flowStep) {\n                // フローステップがある場合は柔軟なポリシーシステムを使用\n                const flexibleResponse = await _utils_api__WEBPACK_IMPORTED_MODULE_1__.api.sendFlexiblePolicyMessage(requestData);\n                // セッション状態を更新\n                if (flexibleResponse.full_state) {\n                    setSessionState({\n                        session_id: flexibleResponse.session_id,\n                        project_id: flexibleResponse.project_id,\n                        ...flexibleResponse.full_state\n                    });\n                }\n                // ステップ移動の処理\n                if (flexibleResponse.type === \"navigate\" && flexibleResponse.navigate_to && onStepChange) {\n                    const targetStep = flexibleResponse.navigate_to;\n                    // ステップ変更のコールバックを実行\n                    onStepChange(targetStep);\n                }\n                assistantMessage = {\n                    id: flexibleResponse.id,\n                    content: flexibleResponse.content,\n                    role: \"assistant\",\n                    timestamp: new Date(flexibleResponse.timestamp),\n                    searchType: undefined\n                };\n            } else {\n                response = await _utils_api__WEBPACK_IMPORTED_MODULE_1__.api.sendMessage(requestData);\n                assistantMessage = convertApiMessageToMessage(response);\n            }\n            // AIレスポンスを追加（関数型更新を使用）\n            setSessions((prevSessions)=>{\n                const finalSessions = prevSessions.map((session)=>session.id === sessionId ? {\n                        ...session,\n                        messages: [\n                            ...session.messages,\n                            assistantMessage\n                        ],\n                        updatedAt: new Date()\n                    } : session);\n                saveSessions(finalSessions);\n                return finalSessions;\n            });\n        } catch (err) {\n            console.error(\"Failed to send message:\", err);\n            console.error(\"Error details:\", {\n                name: err instanceof Error ? err.name : \"Unknown\",\n                message: err instanceof Error ? err.message : \"Unknown error\",\n                stack: err instanceof Error ? err.stack : undefined,\n                apiEndpoint: API_BASE_URL || \"http://127.0.0.1:8000\"\n            });\n            let errorMessage = \"メッセージの送信に失敗しました。\";\n            if (err instanceof _utils_api__WEBPACK_IMPORTED_MODULE_1__.ApiError) {\n                console.log(\"API Error - Status: \".concat(err.status, \", Message: \").concat(err.message));\n                if (err.status === 500) {\n                    errorMessage = \"サーバーエラーが発生しました。(Status: \".concat(err.status, \") しばらく待ってから再試行してください。\");\n                } else if (err.status === 404) {\n                    errorMessage = \"APIエンドポイントが見つかりません。(Status: \".concat(err.status, \") サーバー設定を確認してください。\");\n                } else if (err.status === 0) {\n                    errorMessage = \"ネットワーク接続エラーです。CORS設定またはサーバーの起動状況を確認してください。\";\n                } else {\n                    errorMessage = \"API エラー (Status: \".concat(err.status, \"): \").concat(err.message);\n                }\n            } else if (err instanceof Error) {\n                console.log(\"Generic Error: \".concat(err.message));\n                if (err.message.includes(\"Failed to fetch\") || err.message.includes(\"Network error\")) {\n                    errorMessage = \"ネットワークエラーが発生しました。API URL: \".concat(API_BASE_URL || \"http://127.0.0.1:8000\", \"への接続を確認してください。\");\n                } else if (err.message.includes(\"CORS\")) {\n                    errorMessage = \"CORS エラーが発生しました。サーバーのCORS設定を確認してください。\";\n                } else {\n                    errorMessage = \"エラーが発生しました: \".concat(err.message);\n                }\n            }\n            setError(errorMessage);\n            // エラーメッセージを追加（関数型更新を使用）\n            const errorMessageObj = {\n                id: (Date.now() + 1).toString(),\n                content: \"❌ \".concat(errorMessage),\n                role: \"assistant\",\n                timestamp: new Date()\n            };\n            setSessions((prevSessions)=>{\n                const errorSessions = prevSessions.map((session)=>session.id === sessionId ? {\n                        ...session,\n                        messages: [\n                            ...session.messages,\n                            errorMessageObj\n                        ],\n                        updatedAt: new Date()\n                    } : session);\n                saveSessions(errorSessions);\n                return errorSessions;\n            });\n        } finally{\n            setIsLoading(false);\n        }\n    }, [\n        currentSessionId,\n        createNewSession,\n        saveSessions\n    ]);\n    return {\n        sessions,\n        currentSessionId,\n        messages,\n        sendMessage,\n        selectSession,\n        startNewChat,\n        isLoading,\n        error,\n        sessionState\n    };\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9ob29rcy91c2VDaGF0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBeUQ7QUFFaUI7QUFHMUUsTUFBTUssZUFBZUMsdUJBQW9DLElBQUk7QUFFN0Qsd0JBQXdCO0FBQ3hCLE1BQU1HLGNBQWM7QUFFYixNQUFNQyxVQUFVLENBQUNDO0lBQ3RCLE1BQU0sQ0FBQ0MsVUFBVUMsWUFBWSxHQUFHYiwrQ0FBUUEsQ0FBZ0IsRUFBRTtJQUMxRCxNQUFNLENBQUNjLGtCQUFrQkMsb0JBQW9CLEdBQUdmLCtDQUFRQSxDQUFnQjtJQUN4RSxNQUFNLENBQUNnQixXQUFXQyxhQUFhLEdBQUdqQiwrQ0FBUUEsQ0FBQztJQUMzQyxNQUFNLENBQUNrQixPQUFPQyxTQUFTLEdBQUduQiwrQ0FBUUEsQ0FBZ0I7SUFDbEQsTUFBTSxDQUFDb0IsY0FBY0MsZ0JBQWdCLEdBQUdyQiwrQ0FBUUEsQ0FBc0I7SUFFdEUsTUFBTXNCLGlCQUFpQlYsU0FBU1csSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFQyxFQUFFLEtBQUtYO0lBQ25ELE1BQU1ZLFdBQVdKLENBQUFBLDJCQUFBQSxxQ0FBQUEsZUFBZ0JJLFFBQVEsS0FBSSxFQUFFO0lBRS9DLHdCQUF3QjtJQUN4QnhCLGdEQUFTQSxDQUFDO1FBQ1IsSUFBSTtZQUNGLE1BQU15QixnQkFBZ0JDLGFBQWFDLE9BQU8sQ0FBQ3BCO1lBQzNDLElBQUlrQixlQUFlO2dCQUNqQixNQUFNRyxTQUFTQyxLQUFLQyxLQUFLLENBQUNMO2dCQUMxQixpQkFBaUI7Z0JBQ2pCLE1BQU1NLG9CQUFvQkgsT0FBT0ksR0FBRyxDQUFDLENBQUNDLFVBQWtCO3dCQUN0RCxHQUFHQSxPQUFPO3dCQUNWQyxXQUFXLElBQUlDLEtBQUtGLFFBQVFDLFNBQVM7d0JBQ3JDRSxXQUFXLElBQUlELEtBQUtGLFFBQVFHLFNBQVM7d0JBQ3JDWixVQUFVUyxRQUFRVCxRQUFRLENBQUNRLEdBQUcsQ0FBQyxDQUFDSyxNQUFjO2dDQUM1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QUFlLDZCQUFrRixPQUFyRHBGLGdCQUFnQkMsdUJBQW9DLEVBQUM7Z0JBQ25HLE9BQU8sSUFBSTZFLElBQUlHLE9BQU8sQ0FBQ00sUUFBUSxDQUFDLFNBQVM7b0JBQ3ZDSCxlQUFlO2dCQUNqQixPQUFPO29CQUNMQSxlQUFlLGVBQTJCLE9BQVpOLElBQUlHLE9BQU87Z0JBQzNDO1lBQ0Y7WUFFQW5FLFNBQVNzRTtZQUVULHdCQUF3QjtZQUN4QixNQUFNSSxrQkFBMkI7Z0JBQy9CcEUsSUFBSSxDQUFDWSxLQUFLWSxHQUFHLEtBQUssR0FBR0MsUUFBUTtnQkFDN0JVLFNBQVMsS0FBa0IsT0FBYjZCO2dCQUNkNUIsTUFBTTtnQkFDTnJCLFdBQVcsSUFBSUg7WUFDakI7WUFFQXhCLFlBQVkwQyxDQUFBQTtnQkFDVixNQUFNdUMsZ0JBQWdCdkMsYUFBYXJCLEdBQUcsQ0FBQ0MsQ0FBQUEsVUFDckNBLFFBQVFWLEVBQUUsS0FBS3VCLFlBQ1g7d0JBQ0UsR0FBR2IsT0FBTzt3QkFDVlQsVUFBVTsrQkFBSVMsUUFBUVQsUUFBUTs0QkFBRW1FO3lCQUFnQjt3QkFDaER2RCxXQUFXLElBQUlEO29CQUNqQixJQUNBRjtnQkFFTk8sYUFBYW9EO2dCQUNiLE9BQU9BO1lBQ1Q7UUFDRixTQUFVO1lBQ1I3RSxhQUFhO1FBQ2Y7SUFDRixHQUFHO1FBQUNIO1FBQWtCZ0M7UUFBa0JKO0tBQWE7SUFFckQsT0FBTztRQUNMOUI7UUFDQUU7UUFDQVk7UUFDQXdDO1FBQ0FWO1FBQ0FDO1FBQ0F6QztRQUNBRTtRQUNBRTtJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvaG9va3MvdXNlQ2hhdC50cz9iYTdiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VDYWxsYmFjaywgdXNlRWZmZWN0IH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyBNZXNzYWdlLCBDaGF0U2Vzc2lvbiwgQXBpTWVzc2FnZSB9IGZyb20gJ0AvdHlwZXMvTWVzc2FnZSc7XHJcbmltcG9ydCB7IGFwaSwgQXBpRXJyb3IsIFNlc3Npb25TdGF0ZSwgTWVzc2FnZVJlcXVlc3QgfSBmcm9tICdAL3V0aWxzL2FwaSc7XHJcbmltcG9ydCB0eXBlIHsgRmxvd0tleSB9IGZyb20gJ0AvdHlwZXMvZmxvdyc7XHJcblxyXG5jb25zdCBBUElfQkFTRV9VUkwgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19BUElfRU5EUE9JTlQgfHwgJ2h0dHA6Ly8xMjcuMC4wLjE6ODAwMCc7XHJcblxyXG4vLyDjgrvjg4Pjgrfjg6fjg7PnrqHnkIbjgpLjg63jg7zjgqvjg6vjgrnjg4jjg6zjg7zjgrjjgavmsLjntprljJZcclxuY29uc3QgU1RPUkFHRV9LRVkgPSAnY2hhdF9zZXNzaW9ucyc7XHJcblxyXG5leHBvcnQgY29uc3QgdXNlQ2hhdCA9IChvblN0ZXBDaGFuZ2U/OiAobmV3U3RlcDogRmxvd0tleSkgPT4gdm9pZCkgPT4ge1xyXG4gIGNvbnN0IFtzZXNzaW9ucywgc2V0U2Vzc2lvbnNdID0gdXNlU3RhdGU8Q2hhdFNlc3Npb25bXT4oW10pO1xyXG4gIGNvbnN0IFtjdXJyZW50U2Vzc2lvbklkLCBzZXRDdXJyZW50U2Vzc2lvbklkXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xyXG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW2Vycm9yLCBzZXRFcnJvcl0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcclxuICBjb25zdCBbc2Vzc2lvblN0YXRlLCBzZXRTZXNzaW9uU3RhdGVdID0gdXNlU3RhdGU8U2Vzc2lvblN0YXRlIHwgbnVsbD4obnVsbCk7XHJcbiAgXHJcbiAgY29uc3QgY3VycmVudFNlc3Npb24gPSBzZXNzaW9ucy5maW5kKHMgPT4gcy5pZCA9PT0gY3VycmVudFNlc3Npb25JZCk7XHJcbiAgY29uc3QgbWVzc2FnZXMgPSBjdXJyZW50U2Vzc2lvbj8ubWVzc2FnZXMgfHwgW107XHJcblxyXG4gIC8vIOODreODvOOCq+ODq+OCueODiOODrOODvOOCuOOBi+OCieOCu+ODg+OCt+ODp+ODs+OCkuiqreOBv+i+vOOBv1xyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzYXZlZFNlc3Npb25zID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oU1RPUkFHRV9LRVkpO1xyXG4gICAgICBpZiAoc2F2ZWRTZXNzaW9ucykge1xyXG4gICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2Uoc2F2ZWRTZXNzaW9ucyk7XHJcbiAgICAgICAgLy8gRGF0ZSDjgqrjg5bjgrjjgqfjgq/jg4jjgpLlvqnlhYNcclxuICAgICAgICBjb25zdCBzZXNzaW9uc1dpdGhEYXRlcyA9IHBhcnNlZC5tYXAoKHNlc3Npb246IGFueSkgPT4gKHtcclxuICAgICAgICAgIC4uLnNlc3Npb24sXHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKHNlc3Npb24uY3JlYXRlZEF0KSxcclxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoc2Vzc2lvbi51cGRhdGVkQXQpLFxyXG4gICAgICAgICAgbWVzc2FnZXM6IHNlc3Npb24ubWVzc2FnZXMubWFwKChtc2c6IGFueSkgPT4gKHtcclxuICAgICAgICAgICAgLi4ubXNnLFxyXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKG1zZy50aW1lc3RhbXApXHJcbiAgICAgICAgICB9KSlcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgc2V0U2Vzc2lvbnMoc2Vzc2lvbnNXaXRoRGF0ZXMpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBzZXNzaW9ucyBmcm9tIGxvY2FsU3RvcmFnZTonLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfSwgW10pO1xyXG5cclxuICAvLyDjgrvjg4Pjgrfjg6fjg7PjgpLjg63jg7zjgqvjg6vjgrnjg4jjg6zjg7zjgrjjgavkv53lrZhcclxuICBjb25zdCBzYXZlU2Vzc2lvbnMgPSB1c2VDYWxsYmFjaygobmV3U2Vzc2lvbnM6IENoYXRTZXNzaW9uW10pID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShuZXdTZXNzaW9ucykpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHNhdmUgc2Vzc2lvbnMgdG8gbG9jYWxTdG9yYWdlOicsIGVycm9yKTtcclxuICAgIH1cclxuICB9LCBbXSk7XHJcblxyXG4gIGNvbnN0IGNyZWF0ZU5ld1Nlc3Npb24gPSB1c2VDYWxsYmFjaygoZmlyc3RNZXNzYWdlOiBzdHJpbmcpID0+IHtcclxuICAgIGNvbnN0IHNlc3Npb25JZCA9IERhdGUubm93KCkudG9TdHJpbmcoKTtcclxuICAgIGNvbnN0IHRpdGxlID0gZmlyc3RNZXNzYWdlLmxlbmd0aCA+IDMwID8gZmlyc3RNZXNzYWdlLnN1YnN0cmluZygwLCAzMCkgKyAnLi4uJyA6IGZpcnN0TWVzc2FnZTtcclxuICAgIFxyXG4gICAgY29uc3QgbmV3U2Vzc2lvbjogQ2hhdFNlc3Npb24gPSB7XHJcbiAgICAgIGlkOiBzZXNzaW9uSWQsXHJcbiAgICAgIHRpdGxlLFxyXG4gICAgICBtZXNzYWdlczogW10sXHJcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcclxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgc2V0U2Vzc2lvbnMocHJldlNlc3Npb25zID0+IHtcclxuICAgICAgY29uc3QgbmV3U2Vzc2lvbnMgPSBbbmV3U2Vzc2lvbiwgLi4ucHJldlNlc3Npb25zXTtcclxuICAgICAgc2F2ZVNlc3Npb25zKG5ld1Nlc3Npb25zKTtcclxuICAgICAgcmV0dXJuIG5ld1Nlc3Npb25zO1xyXG4gICAgfSk7XHJcbiAgICBzZXRDdXJyZW50U2Vzc2lvbklkKHNlc3Npb25JZCk7XHJcbiAgICByZXR1cm4gc2Vzc2lvbklkO1xyXG4gIH0sIFtzYXZlU2Vzc2lvbnNdKTtcclxuXHJcbiAgY29uc3Qgc2VsZWN0U2Vzc2lvbiA9IHVzZUNhbGxiYWNrKChzZXNzaW9uSWQ6IHN0cmluZykgPT4ge1xyXG4gICAgc2V0Q3VycmVudFNlc3Npb25JZChzZXNzaW9uSWQpO1xyXG4gICAgc2V0RXJyb3IobnVsbCk7XHJcbiAgfSwgW10pO1xyXG5cclxuICBjb25zdCBzdGFydE5ld0NoYXQgPSB1c2VDYWxsYmFjaygoKSA9PiB7XHJcbiAgICBzZXRDdXJyZW50U2Vzc2lvbklkKG51bGwpO1xyXG4gICAgc2V0RXJyb3IobnVsbCk7XHJcbiAgfSwgW10pO1xyXG5cclxuICBjb25zdCBjb252ZXJ0QXBpTWVzc2FnZVRvTWVzc2FnZSA9IChhcGlNc2c6IEFwaU1lc3NhZ2UpOiBNZXNzYWdlID0+ICh7XHJcbiAgICBpZDogYXBpTXNnLmlkLFxyXG4gICAgY29udGVudDogYXBpTXNnLmNvbnRlbnQsXHJcbiAgICByb2xlOiBhcGlNc2cudHlwZSA9PT0gJ2FpJyA/ICdhc3Npc3RhbnQnIDogJ3VzZXInLFxyXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZShhcGlNc2cudGltZXN0YW1wKSxcclxuICAgIHNlYXJjaFR5cGU6IChhcGlNc2cuc2VhcmNoX3R5cGUgPT09ICdmYWN0JyB8fCBhcGlNc2cuc2VhcmNoX3R5cGUgPT09ICduZXR3b3JrJykgPyBhcGlNc2cuc2VhcmNoX3R5cGUgOiB1bmRlZmluZWQsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHNlbmRNZXNzYWdlID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNvbnRlbnQ6IHN0cmluZywgc2VhcmNoVHlwZT86ICdmYWN0JyB8ICduZXR3b3JrJywgZmxvd1N0ZXA/OiBGbG93S2V5LCBwcm9qZWN0SWQ/OiBzdHJpbmcpID0+IHtcclxuICAgIGxldCBzZXNzaW9uSWQgPSBjdXJyZW50U2Vzc2lvbklkO1xyXG4gICAgXHJcbiAgICAvLyDmlrDjgZfjgYTjgrvjg4Pjgrfjg6fjg7PjgpLkvZzmiJDvvIjliJ3lm57jg6Hjg4Pjgrvjg7zjgrjjga7loLTlkIjvvIlcclxuICAgIGlmICghc2Vzc2lvbklkKSB7XHJcbiAgICAgIHNlc3Npb25JZCA9IGNyZWF0ZU5ld1Nlc3Npb24oY29udGVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdXNlck1lc3NhZ2U6IE1lc3NhZ2UgPSB7XHJcbiAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXHJcbiAgICAgIGNvbnRlbnQsXHJcbiAgICAgIHJvbGU6ICd1c2VyJyxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxyXG4gICAgICBzZWFyY2hUeXBlOiAoc2VhcmNoVHlwZSA9PT0gJ2ZhY3QnIHx8IHNlYXJjaFR5cGUgPT09ICduZXR3b3JrJykgPyBzZWFyY2hUeXBlIDogdW5kZWZpbmVkLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyDjg6bjg7zjgrbjg7zjg6Hjg4Pjgrvjg7zjgrjjgpLov73liqDvvIjplqLmlbDlnovmm7TmlrDjgpLkvb/nlKjvvIlcclxuICAgIHNldFNlc3Npb25zKHByZXZTZXNzaW9ucyA9PiB7XHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRTZXNzaW9ucyA9IHByZXZTZXNzaW9ucy5tYXAoc2Vzc2lvbiA9PiBcclxuICAgICAgICBzZXNzaW9uLmlkID09PSBzZXNzaW9uSWQgXHJcbiAgICAgICAgICA/IHsgXHJcbiAgICAgICAgICAgICAgLi4uc2Vzc2lvbiwgXHJcbiAgICAgICAgICAgICAgbWVzc2FnZXM6IFsuLi5zZXNzaW9uLm1lc3NhZ2VzLCB1c2VyTWVzc2FnZV0sXHJcbiAgICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIDogc2Vzc2lvblxyXG4gICAgICApO1xyXG4gICAgICBzYXZlU2Vzc2lvbnModXBkYXRlZFNlc3Npb25zKTtcclxuICAgICAgcmV0dXJuIHVwZGF0ZWRTZXNzaW9ucztcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XHJcbiAgICBzZXRFcnJvcihudWxsKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyDjg5Djg4Pjgq/jgqjjg7Pjg4njgavjg6Hjg4Pjgrvjg7zjgrjjgpLpgIHkv6FcclxuICAgICAgY29uc3QgcmVxdWVzdERhdGE6IE1lc3NhZ2VSZXF1ZXN0ID0ge1xyXG4gICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgc2VhcmNoX3R5cGU6IHNlYXJjaFR5cGUsXHJcbiAgICAgICAgZmxvd19zdGVwOiBmbG93U3RlcCxcclxuICAgICAgICBzZXNzaW9uX2lkOiBzZXNzaW9uSWQhLFxyXG4gICAgICAgIHByb2plY3RfaWQ6IHByb2plY3RJZCxcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIGxldCByZXNwb25zZTtcclxuICAgICAgbGV0IGFzc2lzdGFudE1lc3NhZ2U7XHJcbiAgICAgIFxyXG4gICAgICAvLyDmpJzntKLjgr/jgqTjg5fjgYzmjIflrprjgZXjgozjgabjgYTjgovloLTlkIjjga9SQUcv6YCa5bi444OB44Oj44OD44OIQVBJ44KS5YSq5YWIXHJcbiAgICAgIC8vIO+8iOODkOODg+OCr+OCqOODs+ODieWBtOOBryBzZWFyY2hfdHlwZSDlhKrlhYjjgaflh6bnkIbjgZXjgozjgovjgZ/jgoEgZmxvd19zdGVwIOWQjOmAgeOBp+OCguWVj+mhjOOBquOBl++8iVxyXG4gICAgICBpZiAoc2VhcmNoVHlwZSA9PT0gJ2ZhY3QnIHx8IHNlYXJjaFR5cGUgPT09ICduZXR3b3JrJykge1xyXG4gICAgICAgIHJlc3BvbnNlID0gYXdhaXQgYXBpLnNlbmRNZXNzYWdlKHJlcXVlc3REYXRhKTtcclxuICAgICAgICBhc3Npc3RhbnRNZXNzYWdlID0gY29udmVydEFwaU1lc3NhZ2VUb01lc3NhZ2UocmVzcG9uc2UpO1xyXG4gICAgICB9IGVsc2UgaWYgKGZsb3dTdGVwKSB7XHJcbiAgICAgICAgLy8g44OV44Ot44O844K544OG44OD44OX44GM44GC44KL5aC05ZCI44Gv5p+U6Luf44Gq44Od44Oq44K344O844K344K544OG44Og44KS5L2/55SoXHJcbiAgICAgICAgY29uc3QgZmxleGlibGVSZXNwb25zZSA9IGF3YWl0IGFwaS5zZW5kRmxleGlibGVQb2xpY3lNZXNzYWdlKHJlcXVlc3REYXRhKTtcclxuXHJcbiAgICAgICAgLy8g44K744OD44K344On44Oz54q25oWL44KS5pu05pawXHJcbiAgICAgICAgaWYgKGZsZXhpYmxlUmVzcG9uc2UuZnVsbF9zdGF0ZSkge1xyXG4gICAgICAgICAgc2V0U2Vzc2lvblN0YXRlKHtcclxuICAgICAgICAgICAgc2Vzc2lvbl9pZDogZmxleGlibGVSZXNwb25zZS5zZXNzaW9uX2lkLFxyXG4gICAgICAgICAgICBwcm9qZWN0X2lkOiBmbGV4aWJsZVJlc3BvbnNlLnByb2plY3RfaWQsXHJcbiAgICAgICAgICAgIC4uLmZsZXhpYmxlUmVzcG9uc2UuZnVsbF9zdGF0ZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyDjgrnjg4bjg4Pjg5fnp7vli5Xjga7lh6bnkIZcclxuICAgICAgICBpZiAoZmxleGlibGVSZXNwb25zZS50eXBlID09PSAnbmF2aWdhdGUnICYmIGZsZXhpYmxlUmVzcG9uc2UubmF2aWdhdGVfdG8gJiYgb25TdGVwQ2hhbmdlKSB7XHJcbiAgICAgICAgICBjb25zdCB0YXJnZXRTdGVwID0gZmxleGlibGVSZXNwb25zZS5uYXZpZ2F0ZV90byBhcyBGbG93S2V5O1xyXG4gICAgICAgICAgLy8g44K544OG44OD44OX5aSJ5pu044Gu44Kz44O844Or44OQ44OD44Kv44KS5a6f6KGMXHJcbiAgICAgICAgICBvblN0ZXBDaGFuZ2UodGFyZ2V0U3RlcCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhc3Npc3RhbnRNZXNzYWdlID0ge1xyXG4gICAgICAgICAgaWQ6IGZsZXhpYmxlUmVzcG9uc2UuaWQsXHJcbiAgICAgICAgICBjb250ZW50OiBmbGV4aWJsZVJlc3BvbnNlLmNvbnRlbnQsXHJcbiAgICAgICAgICByb2xlOiAnYXNzaXN0YW50JyBhcyBjb25zdCxcclxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoZmxleGlibGVSZXNwb25zZS50aW1lc3RhbXApLFxyXG4gICAgICAgICAgc2VhcmNoVHlwZTogdW5kZWZpbmVkLFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBhcGkuc2VuZE1lc3NhZ2UocmVxdWVzdERhdGEpO1xyXG4gICAgICAgIGFzc2lzdGFudE1lc3NhZ2UgPSBjb252ZXJ0QXBpTWVzc2FnZVRvTWVzc2FnZShyZXNwb25zZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEFJ44Os44K544Od44Oz44K544KS6L+95Yqg77yI6Zai5pWw5Z6L5pu05paw44KS5L2/55So77yJXHJcbiAgICAgIHNldFNlc3Npb25zKHByZXZTZXNzaW9ucyA9PiB7XHJcbiAgICAgICAgY29uc3QgZmluYWxTZXNzaW9ucyA9IHByZXZTZXNzaW9ucy5tYXAoc2Vzc2lvbiA9PiBcclxuICAgICAgICAgIHNlc3Npb24uaWQgPT09IHNlc3Npb25JZCBcclxuICAgICAgICAgICAgPyB7IFxyXG4gICAgICAgICAgICAgICAgLi4uc2Vzc2lvbiwgXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogWy4uLnNlc3Npb24ubWVzc2FnZXMsIGFzc2lzdGFudE1lc3NhZ2VdLFxyXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICA6IHNlc3Npb25cclxuICAgICAgICApO1xyXG4gICAgICAgIHNhdmVTZXNzaW9ucyhmaW5hbFNlc3Npb25zKTtcclxuICAgICAgICByZXR1cm4gZmluYWxTZXNzaW9ucztcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzZW5kIG1lc3NhZ2U6JywgZXJyKTtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGV0YWlsczonLCB7XHJcbiAgICAgICAgbmFtZTogZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubmFtZSA6ICdVbmtub3duJyxcclxuICAgICAgICBtZXNzYWdlOiBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxyXG4gICAgICAgIHN0YWNrOiBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5zdGFjayA6IHVuZGVmaW5lZCxcclxuICAgICAgICBhcGlFbmRwb2ludDogQVBJX0JBU0VfVVJMIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQSV9FTkRQT0lOVFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAn44Oh44OD44K744O844K444Gu6YCB5L+h44Gr5aSx5pWX44GX44G+44GX44Gf44CCJztcclxuICAgICAgXHJcbiAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBBcGlFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBBUEkgRXJyb3IgLSBTdGF0dXM6ICR7ZXJyLnN0YXR1c30sIE1lc3NhZ2U6ICR7ZXJyLm1lc3NhZ2V9YCk7XHJcbiAgICAgICAgaWYgKGVyci5zdGF0dXMgPT09IDUwMCkge1xyXG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gYOOCteODvOODkOODvOOCqOODqeODvOOBjOeZuueUn+OBl+OBvuOBl+OBn+OAgihTdGF0dXM6ICR7ZXJyLnN0YXR1c30pIOOBl+OBsOOCieOBj+W+heOBo+OBpuOBi+OCieWGjeippuihjOOBl+OBpuOBj+OBoOOBleOBhOOAgmA7XHJcbiAgICAgICAgfSBlbHNlIGlmIChlcnIuc3RhdHVzID09PSA0MDQpIHtcclxuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGBBUEnjgqjjg7Pjg4njg53jgqTjg7Pjg4jjgYzopovjgaTjgYvjgorjgb7jgZvjgpPjgIIoU3RhdHVzOiAke2Vyci5zdGF0dXN9KSDjgrXjg7zjg5Djg7zoqK3lrprjgpLnorroqo3jgZfjgabjgY/jgaDjgZXjgYTjgIJgO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXJyLnN0YXR1cyA9PT0gMCkge1xyXG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gYOODjeODg+ODiOODr+ODvOOCr+aOpee2muOCqOODqeODvOOBp+OBmeOAgkNPUlPoqK3lrprjgb7jgZ/jga/jgrXjg7zjg5Djg7zjga7otbfli5Xnirbms4HjgpLnorroqo3jgZfjgabjgY/jgaDjgZXjgYTjgIJgO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBgQVBJIOOCqOODqeODvCAoU3RhdHVzOiAke2Vyci5zdGF0dXN9KTogJHtlcnIubWVzc2FnZX1gO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBHZW5lcmljIEVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xyXG4gICAgICAgIGlmIChlcnIubWVzc2FnZS5pbmNsdWRlcygnRmFpbGVkIHRvIGZldGNoJykgfHwgZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ05ldHdvcmsgZXJyb3InKSkge1xyXG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gYOODjeODg+ODiOODr+ODvOOCr+OCqOODqeODvOOBjOeZuueUn+OBl+OBvuOBl+OBn+OAgkFQSSBVUkw6ICR7QVBJX0JBU0VfVVJMIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0FQSV9FTkRQT0lOVH3jgbjjga7mjqXntprjgpLnorroqo3jgZfjgabjgY/jgaDjgZXjgYTjgIJgO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZXJyLm1lc3NhZ2UuaW5jbHVkZXMoJ0NPUlMnKSkge1xyXG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gJ0NPUlMg44Ko44Op44O844GM55m655Sf44GX44G+44GX44Gf44CC44K144O844OQ44O844GuQ09SU+ioreWumuOCkueiuuiqjeOBl+OBpuOBj+OBoOOBleOBhOOAgic7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IGDjgqjjg6njg7zjgYznmbrnlJ/jgZfjgb7jgZfjgZ86ICR7ZXJyLm1lc3NhZ2V9YDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHNldEVycm9yKGVycm9yTWVzc2FnZSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyDjgqjjg6njg7zjg6Hjg4Pjgrvjg7zjgrjjgpLov73liqDvvIjplqLmlbDlnovmm7TmlrDjgpLkvb/nlKjvvIlcclxuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlT2JqOiBNZXNzYWdlID0ge1xyXG4gICAgICAgIGlkOiAoRGF0ZS5ub3coKSArIDEpLnRvU3RyaW5nKCksXHJcbiAgICAgICAgY29udGVudDogYOKdjCAke2Vycm9yTWVzc2FnZX1gLFxyXG4gICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHNldFNlc3Npb25zKHByZXZTZXNzaW9ucyA9PiB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JTZXNzaW9ucyA9IHByZXZTZXNzaW9ucy5tYXAoc2Vzc2lvbiA9PiBcclxuICAgICAgICAgIHNlc3Npb24uaWQgPT09IHNlc3Npb25JZCBcclxuICAgICAgICAgICAgPyB7IFxyXG4gICAgICAgICAgICAgICAgLi4uc2Vzc2lvbiwgXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlczogWy4uLnNlc3Npb24ubWVzc2FnZXMsIGVycm9yTWVzc2FnZU9ial0sXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIDogc2Vzc2lvblxyXG4gICAgICAgICk7XHJcbiAgICAgICAgc2F2ZVNlc3Npb25zKGVycm9yU2Vzc2lvbnMpO1xyXG4gICAgICAgIHJldHVybiBlcnJvclNlc3Npb25zO1xyXG4gICAgICB9KTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9XHJcbiAgfSwgW2N1cnJlbnRTZXNzaW9uSWQsIGNyZWF0ZU5ld1Nlc3Npb24sIHNhdmVTZXNzaW9uc10pO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgc2Vzc2lvbnMsXHJcbiAgICBjdXJyZW50U2Vzc2lvbklkLFxyXG4gICAgbWVzc2FnZXMsXHJcbiAgICBzZW5kTWVzc2FnZSxcclxuICAgIHNlbGVjdFNlc3Npb24sXHJcbiAgICBzdGFydE5ld0NoYXQsXHJcbiAgICBpc0xvYWRpbmcsXHJcbiAgICBlcnJvcixcclxuICAgIHNlc3Npb25TdGF0ZSxcclxuICB9O1xyXG59OyJdLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZUNhbGxiYWNrIiwidXNlRWZmZWN0IiwiYXBpIiwiQXBpRXJyb3IiLCJBUElfQkFTRV9VUkwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQVBJX0VORFBPSU5UIiwiU1RPUkFHRV9LRVkiLCJ1c2VDaGF0Iiwib25TdGVwQ2hhbmdlIiwic2Vzc2lvbnMiLCJzZXRTZXNzaW9ucyIsImN1cnJlbnRTZXNzaW9uSWQiLCJzZXRDdXJyZW50U2Vzc2lvbklkIiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwiZXJyb3IiLCJzZXRFcnJvciIsInNlc3Npb25TdGF0ZSIsInNldFNlc3Npb25TdGF0ZSIsImN1cnJlbnRTZXNzaW9uIiwiZmluZCIsInMiLCJpZCIsIm1lc3NhZ2VzIiwic2F2ZWRTZXNzaW9ucyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJwYXJzZWQiLCJKU09OIiwicGFyc2UiLCJzZXNzaW9uc1dpdGhEYXRlcyIsIm1hcCIsInNlc3Npb24iLCJjcmVhdGVkQXQiLCJEYXRlIiwidXBkYXRlZEF0IiwibXNnIiwidGltZXN0YW1wIiwiY29uc29sZSIsInNhdmVTZXNzaW9ucyIsIm5ld1Nlc3Npb25zIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImNyZWF0ZU5ld1Nlc3Npb24iLCJmaXJzdE1lc3NhZ2UiLCJzZXNzaW9uSWQiLCJub3ciLCJ0b1N0cmluZyIsInRpdGxlIiwibGVuZ3RoIiwic3Vic3RyaW5nIiwibmV3U2Vzc2lvbiIsInByZXZTZXNzaW9ucyIsInNlbGVjdFNlc3Npb24iLCJzdGFydE5ld0NoYXQiLCJjb252ZXJ0QXBpTWVzc2FnZVRvTWVzc2FnZSIsImFwaU1zZyIsImNvbnRlbnQiLCJyb2xlIiwidHlwZSIsInNlYXJjaFR5cGUiLCJzZWFyY2hfdHlwZSIsInVuZGVmaW5lZCIsInNlbmRNZXNzYWdlIiwiZmxvd1N0ZXAiLCJwcm9qZWN0SWQiLCJ1c2VyTWVzc2FnZSIsInVwZGF0ZWRTZXNzaW9ucyIsInJlcXVlc3REYXRhIiwiZmxvd19zdGVwIiwic2Vzc2lvbl9pZCIsInByb2plY3RfaWQiLCJyZXNwb25zZSIsImFzc2lzdGFudE1lc3NhZ2UiLCJmbGV4aWJsZVJlc3BvbnNlIiwic2VuZEZsZXhpYmxlUG9saWN5TWVzc2FnZSIsImZ1bGxfc3RhdGUiLCJuYXZpZ2F0ZV90byIsInRhcmdldFN0ZXAiLCJmaW5hbFNlc3Npb25zIiwiZXJyIiwibmFtZSIsIkVycm9yIiwibWVzc2FnZSIsInN0YWNrIiwiYXBpRW5kcG9pbnQiLCJlcnJvck1lc3NhZ2UiLCJsb2ciLCJzdGF0dXMiLCJpbmNsdWRlcyIsImVycm9yTWVzc2FnZU9iaiIsImVycm9yU2Vzc2lvbnMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/hooks/useChat.ts\n"));

/***/ })

});